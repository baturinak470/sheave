//tealium universal tag - utag.112 ut4.0.201911251552, Copyright 2019 Tealium.com Inc. All Rights Reserved.
(function(m,k){var p=function(){var c=this;this.mediaStVersion="414";this.instance=[];this.mediaSessions={};this.maxMediaRequests=500;this.ignoreDuplicatedRequest=!0;this.ignoreDuplicatedRequestTimeout=3E3;var f=function(){},p=function(a){a=a.split("&");for(var b="?",d=0,c=a.length;c;)d=parseInt(Math.random()*c),b+=a.splice(d,1)+"&",c--;return b.substr(0,b.length-1)},q=function(){for(var a=parseInt(10*Math.random())+5,b="",d=0,c;d<a;d++)c=parseInt(37*Math.random()),b+="abcdefghijklmnopqrstuvwxyz-_0123456789".charAt(c);return b};this.getPixelInstance=function(a,b){if("undefined"!==typeof webtrekkUnloadObjects)for(var d=0,c=webtrekkUnloadObjects.length;d<c;d++){var e=webtrekkUnloadObjects[d];if(e.trackId){"1"!==e.cookie||e.eid||e.firstParty();"undefined"===typeof e.requestObfuscation&&(e.requestObfuscation=!1);"undefined"===typeof e.executePlugin&&(e.executePlugin=f);"undefined"===typeof e.getPluginConfig&&(e.getPluginConfig=f);if(e.trackId===a)return[e];if(-1!==e.trackId.indexOf(a))return[{trackDomain:b,trackId:a,eid:e.eid,pixelSampling:e.pixelSampling,deactivatePixel:e.deactivatePixel,executePlugin:e.executePlugin,getPluginConfig:e.getPluginConfig,requestObfuscation:e.requestObfuscation}]}}return"undefined"!==typeof webtrekk&&webtrekk.trackId&&webtrekk.trackDomain?(webtrekk.eid="undefined"!==typeof wt_cookie_eid?wt_cookie_eid:!1,webtrekk.deactivatePixel="undefined"!==typeof wt_deactivatePixel?wt_deactivatePixel:!1,webtrekk.requestObfuscation=!1,webtrekk.executePlugin=f,webtrekk.getPluginConfig=f,[webtrekk]):[]};this.getAllPixelInstances=function(){if("undefined"!==typeof webtrekkUnloadObjects){for(var a=0,b=webtrekkUnloadObjects.length;a<b;a++){var d=webtrekkUnloadObjects[a];"1"!==d.cookie||d.eid||d.firstParty();"undefined"===typeof d.requestObfuscation&&(d.requestObfuscation=!1);"undefined"===typeof d.executePlugin&&(d.executePlugin=f);"undefined"===typeof d.getPluginConfig&&(d.getPluginConfig=f)}return webtrekkUnloadObjects}return[]};this.escape=function(a){try{return encodeURIComponent(a)}catch(b){return escape(a)}};this.getMediaCategory=function(a,b){var d="",g,e;for(e in b)if(g=e+"",a||-1===g.indexOf("mg"))d+="&"+g+"="+c.escape(b[g]);return d};this.init=function(a,b,d){d=d?d:0;a&&b&&(c.instance=c.getPixelInstance(b,a),0>=c.instance.length&&(a={trackDomain:a,trackId:b,eid:!1,pixelSampling:d?d:0,deactivatePixel:!1,executePlugin:f,getPluginConfig:f,requestObfuscation:!1},Math&&(Math.random&&0!==parseInt(Math.random()*parseInt(d)))&&(a.deactivatePixel=!0),c.instance.push(a)))};this.getPositionInterval=function(a){var b="undefined"!==typeof wt_mediaInterval?parseInt(wt_mediaInterval):60;return"0"===a?15E3:10<=parseInt(a)/b?1E3*(parseInt(a)/b):1E4};this.checkPositionTime=function(a){a=c.mediaSessions[a];if(null===a.posTime)return a.posTime=(new Date).getTime(),!0;var b=(new Date).getTime();if(b-a.posTime<a.posInterval)return!1;a.posTime=b;return!0};this.checkMediaRequest=function(a,b,d){if(!c.ignoreDuplicatedRequest)return!0;a=c.mediaSessions[a];b=b+"_"+d;if("undefined"===typeof a.sendMediaRequest[b])a.sendMediaRequest[b]=(new Date).getTime();else{d=(new Date).getTime();if(d-a.sendMediaRequest[b]<=c.ignoreDuplicatedRequestTimeout)return a.sendMediaRequest[b]=d,!1;a.sendMediaRequest[b]=d}return!0};this.initializeMediaSession=function(a,b,d){"init"===d&&"undefined"!==typeof c.mediaSessions[a]&&delete c.mediaSessions[a];"undefined"===typeof c.mediaSessions[a]&&(c.mediaSessions[a]={posInterval:c.getPositionInterval(b),posTime:null,maxMediaRequests:"undefined"!==typeof wt_maxMediaRequests?wt_maxMediaRequests:c.maxMediaRequests,sendMediaRequest:{}},c.ignoreDuplicatedRequest="undefined"!==typeof wt_ignoreDuplicatedRequest?wt_ignoreDuplicatedRequest:!0,c.ignoreDuplicatedRequestTimeout="undefined"!==typeof wt_ignoreDuplicatedRequestTimeout?parseInt(wt_ignoreDuplicatedRequestTimeout):3E3)};this.sendinfo_media=function(a,b,d,g,e,n,l,h){if(a&&(0>=c.instance.length&&("object"===typeof webtrekk&&webtrekk.trackDomain&&webtrekk.trackId?c.init(webtrekk.trackDomain,webtrekk.trackId):c.instance=c.getAllPixelInstances()),!(0>=c.instance.length))){if(!g||isNaN(parseInt(g)))g="0";var f="init"===b||"play"===b,k="";n="&bw="+(n?n:"")+("&vol="+(l?l:""));n+="&mut="+(h?h:"");n+="&pu="+c.escape(m.document.location.href.split("#")[0]);if(e)if("string"===typeof e){k=e.split(";");e={};for(h=0;h<k.length;h++)l=k[h].split("="),2<=l.length&&(e[l[0]]=l[1]);k=c.getMediaCategory(f,e)}else"object"===typeof e&&(k=c.getMediaCategory(f,e));c.initializeMediaSession(a,g,b);if(!("pos"===b&&!c.checkPositionTime(a)||"pos"!==b&&!c.checkMediaRequest(a,b,d)||0>=c.mediaSessions[a].maxMediaRequests&&"eof"!==b&&"stop"!==b))for(c.mediaSessions[a].maxMediaRequests--,"eof"!==b&&"stop"!==b||delete c.mediaSessions[a],f=0;f<c.instance.length;f++)e=c.instance[f],e.deactivatePixel||(h="st,1,"+c.baseparams()+"&mi="+c.escape(a)+"&mk="+c.escape(b)+"&mt1="+d+"&mt2="+g,e.eid&&(h+="&eid="+e.eid),h+=k,h+=n,e.executePlugin(e.getPluginConfig("media","before")),c.quicksend(e,h),e.executePlugin(e.getPluginConfig("media","after")))}};this.quicksend=function(a,b){if(!a.deactivatePixel){var d=a.trackDomain,g=a.trackId,e="wt";a.requestObfuscation&&(e+=q());b="p="+c.mediaStVersion+","+b;var f="https:"==location.protocol?"https:":"http:",f=f+("//"+d+"/"+g+"/"+e),f=a.requestObfuscation?f+p(b):f+("?"+b),d={};d.Image="function"!==typeof m.Image?function(){return k.createElement("img")}:m.Image;if("undefined"===typeof l)var l=[];g=l.length;l[g]=new d.Image;l[g].onload=function(){return!1};l[g].src=f}};this.getBrowserHeight=function(){var a=0;try{a=m.innerHeight}catch(b){}if(!a)try{a=k.documentElement.clientHeight}catch(d){}if(!a)try{a=k.body.clientHeight}catch(c){}"undefined"===typeof a&&(a=-1);return a};this.getBrowserWidth=function(){var a=0;try{a=m.innerWidth}catch(b){}if(!a)try{a=k.documentElement.clientWidth}catch(d){}if(!a)try{a=k.body.clientWidth}catch(c){}"undefined"===typeof a&&(a=-1);return a};this.baseparams=function(){var a=screen.width+"x"+screen.height+",",a=a+(("Netscape"!=navigator.appName?screen.colorDepth:screen.pixelDepth)+","),a=a+(navigator.cookieEnabled?"1,":navigator.cookieEnabled?-1!=k.cookie.indexOf("=")?"1,":"0,":"0,"),a=a+((new Date).getTime()+","),a=a+"1",b=c.getBrowserHeight(),d=c.getBrowserWidth();b&&b>screen.height&&(b=screen.height);d&&d>screen.width&&(d=screen.width);return a=a+(","+d+"x"+b)+(","+(navigator.javaEnabled()?"1":"0"))};m.wt_init_media=c.init;m.wt_sendinfo_media=c.sendinfo_media};"undefined"===typeof m.webtrekkMediaTracking&&m.webtrekkMediaTracking instanceof p||(m.webtrekkMediaTracking=new p)})(window,document);if(utag.data.tealium_environment=='prod'){wt_init_media("mediasetitalia01.wt-eu02.net","769396664005295");}
else{wt_init_media("mediasetitalia01.wt-eu02.net","653795874427098");}
wt_mediaInterval=1000000;try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag===undefined){utag={};}if(utag.ut===undefined){utag.ut={};}if(utag.ut.loader===undefined){u.loader=function(o){var a,b,c,l;a=document;if(o.type==="iframe"){b=a.createElement("iframe");b.setAttribute("height","1");b.setAttribute("width","1");b.setAttribute("style","display:none");b.setAttribute("src",o.src);}else if(o.type==="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";b.src=o.src;}if(o.id){b.id=o.id;}if(typeof o.cb==="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState==="loaded"){this.onreadystatechange=null;o.cb();}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l==="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}};}else{u.loader=utag.ut.loader;}
u.ev={'view':0,'link':1};u.initialized=false;u.map={"video_event_type":"video_event_type","video_playhead":"video_playhead"};u.extend=[function(a,b){try{if(1){function extractHostname(url){var hostname;if(url.indexOf("//")>-1){hostname=url.split('/')[2];}else{hostname=url.split('/')[0];}
hostname=hostname.replace('www.','');hostname=hostname.split(':')[0];hostname=hostname.split('?')[0];return hostname;}
function findFromArray(searchArray,str){for(var i in searchArray){if(str.indexOf(searchArray[i])>-1){return true;}}
return false;}
function partnersCalculation(){if(!utag.data.rti_webtrekk_video_mg9&&!utag.data.rti_webtrekk_video_mg10){if(utag.data.page_url){b.rti_webtrekk_video_mg9="terzi";b.rti_webtrekk_video_mg10="terzi";utag.data.rti_webtrekk_video_mg9="terzi";utag.data.rti_webtrekk_video_mg10="terzi";if(utag.data.third_parties_data){for(i=0;i<utag.data.third_parties_data.length;i++){if(utag.data.page_url.indexOf(utag.data.third_parties_data[i].domain)!==-1&&utag.data.third_parties_data[i].domain!==""){b.rti_webtrekk_video_mg9=utag.data.third_parties_data[i].groupLabel;b.rti_webtrekk_video_mg10=utag.data.third_parties_data[i].subGroupLabel;utag.data.rti_webtrekk_video_mg9=utag.data.third_parties_data[i].groupLabel;utag.data.rti_webtrekk_video_mg10=utag.data.third_parties_data[i].subGroupLabel;break;}}}else{for(i=0;i<__dshGlobalMethods.rti_partners.length;i++){for(j=0;j<__dshGlobalMethods.rti_partners[i].domains.length;j++){if(utag.data.page_url.indexOf(__dshGlobalMethods.rti_partners[i].domains[j].domain)!==-1&&__dshGlobalMethods.rti_partners[i].domains[j].domain!==""){b.rti_webtrekk_video_mg9=__dshGlobalMethods.rti_partners[i].label;b.rti_webtrekk_video_mg10=__dshGlobalMethods.rti_partners[i].domains[j].label;utag.data.rti_webtrekk_video_mg9=__dshGlobalMethods.rti_partners[i].label;utag.data.rti_webtrekk_video_mg10=__dshGlobalMethods.rti_partners[i].domains[j].label;break;}}}}}else{b.rti_webtrekk_video_mg9="mediaset";b.rti_webtrekk_video_mg10="mediaset";utag.data.rti_webtrekk_video_mg9="mediaset";utag.data.rti_webtrekk_video_mg10="mediaset";}}
else{b.rti_webtrekk_video_mg9=b.rti_webtrekk_video_mg9||utag.data.rti_webtrekk_video_mg9;b.rti_webtrekk_video_mg10=b.rti_webtrekk_video_mg10||utag.data.rti_webtrekk_video_mg10;}
}
function mediaCalculation(){partnersCalculation();var res=(u.data.rti_webtrekk_video_miprefix?u.data.rti_webtrekk_video_miprefix.toLowerCase():u.data.rti_webtrekk_video_miprefix)+"-"+__dshGlobalMethods.getType(b).toLowerCase()+"-"+__dshGlobalMethods.getVideoCategory(b).toLowerCase()+"-"+__dshGlobalMethods.getBrandTitle(b)+"-"+b.video_id+"-"+(b.video_name?b.video_name.toLowerCase():b.video_name);if(b.rti_webtrekk_video_mg9!=="mediaset"&&b.rti_webtrekk_video_mg10!=="mediaset"){res+="-"+(b.rti_webtrekk_video_mg9?b.rti_webtrekk_video_mg9.toLowerCase():b.rti_webtrekk_video_mg9)+"-"+(b.rti_webtrekk_video_mg10?b.rti_webtrekk_video_mg10.toLowerCase():b.rti_webtrekk_video_mg10);}
return res;}
function getMG(){var mg={};mg.mg1=__dshGlobalMethods.getBrandTitle(b);if(b.video_subbrand_title)
mg.mg2=b.video_subbrand_title;if(b.video_area)
mg.mg3=b.video_area;mg.mg4=__dshGlobalMethods.getType(b);mg.mg5=__dshGlobalMethods.getVideoCategory(b);mg.mg6=__dshGlobalMethods.getBrandTitle(b)+"-"+mg.mg5+"-"+(b.video_name?b.video_name.toLowerCase():"");mg.mg7=b.video_id;mg.mg8=__dshGlobalMethods.checkAndReturn(b,'rti_webtrekk_video_mg8',"mediaset").toLowerCase();mg.mg9=b.rti_webtrekk_video_mg9?b.rti_webtrekk_video_mg9.toLowerCase():b.rti_webtrekk_video_mg9;mg.mg10=b.rti_webtrekk_video_mg10?b.rti_webtrekk_video_mg10.toLowerCase():b.rti_webtrekk_video_mg10;mg.mg11=__dshGlobalMethods.getPlatform(b);if(b.video_asset_url)
mg.mg14=b.video_asset_url;if(b.video_thumb)
mg.mg15=b.video_thumb
if(utag.data.page_url&&utag.data.page_url!=="")
mg.ck16=utag.data.page_url;var webtrekkMg='';for(var i in mg){webtrekkMg+=i+'='+mg[i]+';';}
return webtrekkMg.slice(0,-1);}
function getCk(){var ck={};var pUrl=__dshGlobalMethods.checkAndReturn(b,'page_url',null);if(pUrl){var tpd=__dshGlobalMethods.findThirdPartyFromDomain(pUrl);if(tpd){ck.ck20=tpd.freewheel&&tpd.freewheel!=""?tpd.freewheel:"mediasetplay";}
else{ck.ck20="notavailable";}}
else{ck.ck20="mediasetplay";}
if(utag.data.ab)
ck.ck21=utag.data.ab;ck.ck22=utag.data.rti_play_ad_block===true?"si":"no";if(b.video_ad_instance_id)
ck.ck23=b.video_ad_instance_id;if(utag.data["meta.app-version"])
ck.ck24=__dshGlobalMethods.extractAppName(utag.data["meta.app-version"]);if(b.video_autoplay)
ck.ck26=b.video_autoplay;if(b.video_player_behavior){ck.ck27=b.video_player_behavior;}else{ck.ck27="standard";}
if(b.video_play_reason)
ck.ck27=b.video_play_reason+"-"+ck.ck27;var webtrekkCk='';for(var i in ck){webtrekkCk+=i+'='+ck[i]+';';}
return webtrekkCk.slice(0,-1);}
var platform=__dshGlobalMethods.getPlatform(b);u.data.rti_webtrekk_video_mg11=platform;u.data.rti_webtrekk_video_miprefix="mediaset-"+platform+"-videomediaset";utag.data.rti_webtrekk_video_mg11=platform;utag.data.rti_webtrekk_video_miprefix="mediaset-"+platform+"-videomediaset";if(platform=='web'){if(__dshGlobalMethods.isEmbed(b)){var misiteprefix="videomediaset";var pUrl=__dshGlobalMethods.checkAndReturn(b,'page_url',null);if(pUrl){if(findFromArray(["tgcom24.mediaset.it","tgcom24.it"],pUrl)){misiteprefix="tgcom24";}else if(findFromArray(["sportmediaset.mediaset.it","sportmediaset.it"],pUrl)){misiteprefix="sportmediaset";}else if(findFromArray(["meteo.mediaset.it","meteo.it"],pUrl)){misiteprefix="meteo";}else if(findFromArray(["grandefratello.mediaset.it","grandefratello.it"],pUrl)){misiteprefix="grande fratello";}else if(findFromArray(['wittytv.it'],pUrl)){misiteprefix="witty tv";}else if(findFromArray(['iene.mediaset.it','iene.it'],pUrl)){misiteprefix="iene";}else if(findFromArray(['striscialanotizia.mediaset.it'],pUrl)){misiteprefix="striscia la notizia";}else if(findFromArray(['isola.mediaset.it'],pUrl)){misiteprefix="isola dei famosi";}else if(findFromArray(['verissimo.mediaset.it'],pUrl)){misiteprefix="verissimo";}}
u.data.rti_webtrekk_video_miprefix="mediaset-"+platform+"-"+misiteprefix;utag.data.rti_webtrekk_video_miprefix="mediaset-"+platform+"-"+misiteprefix;}}else if(platform=='app'){var postfix='';var appToPostFix={'iOS':{'it.mediaset.tg5':'tg5','it.mediaset.tgcom':'tgcom24','org.epson-meteo.meteo.it':'meteo.it','it.mediaset.mediasetconnect':'secondscreen','it.mediaset.sport':'sportmediaset','it.mediaset.video.iphone':'videomediaset','test.it.mediaset.RTILabSDKSample':'videomediaset.test'},'Android':{'it.mediaset.tg5.android':'tg5','it.froggy.tgcom':'tgcom24','it.froggymedia.sportmediaset':'sportmediaset','it.fabbricadigitale.meteoit.page':'meteo.it','it.mediaset.mediasetconnect.android':'secondscreen','it.fabbricadigitale.android.videomediaset':'videomediaset','it.mediaset.lab.sdk.sample':'videomediaset.test'},'android':{'it.mediaset.tg5.android':'tg5','it.froggy.tgcom':'tgcom24','it.froggymedia.sportmediaset':'sportmediaset','it.fabbricadigitale.meteoit.page':'meteo.it','it.mediaset.mediasetconnect.android':'secondscreen','it.fabbricadigitale.android.videomediaset':'videomediaset','it.mediaset.lab.sdk.sample':'videomediaset.test'},'app':{'it.mediaset.tg5':'tg5','it.mediaset.tgcom':'tgcom24','org.epson-meteo.meteo.it':'meteo.it','it.mediaset.mediasetconnect':'secondscreen','it.mediaset.sport':'sportmediaset','it.mediaset.video.iphone':'videomediaset','test.it.mediaset.RTILabSDKSample':'videomediaset.test','it.mediaset.tg5.android':'tg5','it.froggy.tgcom':'tgcom24','it.froggymedia.sportmediaset':'sportmediaset','it.fabbricadigitale.meteoit.page':'meteo.it','it.mediaset.mediasetconnect.android':'secondscreen','it.fabbricadigitale.android.videomediaset':'videomediaset','it.mediaset.lab.sdk.sample':'videomediaset.test'}};u.data.rti_webtrekk_video_miprefix="mediaset-"+platform+"-"+(appToPostFix[!b.platform?'app':b.platform][b.app_rdns]?appToPostFix[!b.platform?'app':b.platform][b.app_rdns]:'');utag.data.rti_webtrekk_video_miprefix="mediaset-"+platform+"-"+(appToPostFix[!b.platform?'app':b.platform][b.app_rdns]?appToPostFix[!b.platform?'app':b.platform][b.app_rdns]:'');}
u.data.rti_webtrekk_video_mc=mediaCalculation();b.rti_webtrekk_cg1="embed-video";b.rti_webtrekk_cg2="embed-video-"+b.rti_webtrekk_video_mg9;b.rti_webtrekk_cg3="embed-video-"+b.rti_webtrekk_video_mg9+"-"+b.rti_webtrekk_video_mg10;b.rti_webtrekk_config_cid="embed-video-"+b.rti_webtrekk_video_mg9+"-"+b.rti_webtrekk_video_mg10;u.data.rti_webtrekk_video_mg=getMG();u.data.rti_webtrekk_video_ck=getCk().toLowerCase();u.data.video_bandwidth=b.video_bandwidth||0;u.data.video_duration_in_s=__dshGlobalMethods.getDurationSec(b);var volPerc=parseInt(b.video_volume*100,10);u.data.video_volume=volPerc<=100?volPerc:100;u.data.video_mute=u.data.video_volume>0?0:1;var type=__dshGlobalMethods.getType(b);u.data.video_type=type;if(utag.data.rti_play_storage&&utag.data.rti_play_storage[b.video_play_request_id]){u.data.is_buffering=utag.data.rti_play_storage[b.video_play_request_id].is_buffering;u.data.is_complete=utag.data.rti_play_storage[b.video_play_request_id].is_complete;u.data.is_eof=utag.data.rti_play_storage[b.video_play_request_id].is_eof;u.data.is_pause=utag.data.rti_play_storage[b.video_play_request_id].is_pause;u.data.rti_midroll_count=utag.data.rti_play_storage[b.video_play_request_id].ad_midroll_count;u.data.last_played_type=utag.data.rti_play_storage[b.video_play_request_id].last_played_type;u.data.last_user_action=utag.data.rti_play_storage[b.video_play_request_id].last_user_action?utag.data.rti_play_storage[b.video_play_request_id].last_user_action:null;u.data.rti_alive_to_send=utag.data.rti_play_storage[b.video_play_request_id].alive["30"].alive_to_send===true?true:false;u.data.rti_alive_to_send_pos=u.data.rti_alive_to_send?utag.data.rti_play_storage[b.video_play_request_id].alive["30"].alive_last_time:0;u.data.seek_keep_watching=utag.data.rti_play_storage[b.video_play_request_id].seek_keep_watching;}
}}catch(e){utag.DB(e)}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f,i;u.data={"is_buffering":false,"is_complete":false,"is_eof":false,"is_pause":false,"last_played_type":"","last_played_type_changed":false,"last_user_action":null,"rti_alive_to_send":false,"rti_alive_to_send_pos":0,"rti_webtrekk_video_miprefix":"mediaset-web-videomediaset","rti_webtrekk_video_mc":"","rti_webtrekk_video_mg":"","rti_webtrekk_video_ck":"","rti_midroll_count":0,"seek_keep_watching":{"to_clean":false,"to_send":false,"playhead":0},"video_duration_in_s":0,"video_bandwidth":0,"video_volume":100,"video_mute":0,"video_type":null};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
var logPrefix='Webtrekk - Tag - '+b.video_play_request_id+' - ';var prIDHb=b.video_play_request_id+"-hb";function nextHb(playhead,frequency){if(frequency===undefined)frequency=30;var hb=frequency-parseInt(playhead,10)%frequency;return hb>0?hb:frequency;}
function sendHb(){var type=__dshGlobalMethods.getType(b);var playhead=Math.round(window.rtiTealliumVideoTimer.playhead(prIDHb)/1000);utag.DB('sendHb received id: '+b.video_play_request_id+' playhead '+playhead);var now=Date.now();for(var i in utag.data.rti_play_storage[b.video_play_request_id].alive){var last=utag.data.rti_play_storage[b.video_play_request_id].alive[i].alive_last_time;var posAlive=__dshGlobalMethods.roundTo(playhead,i);if(posAlive>last&&(posAlive>=playhead-1)){utag.data.rti_play_storage[b.video_play_request_id].alive[i].alive_last_time=posAlive;utag.data.rti_play_storage[b.video_play_request_id].alive[i].alive_to_send=true;}
else{utag.data.rti_play_storage[b.video_play_request_id].alive[i].alive_to_send=false;}
utag.DB('DSH - HB ALive: '+posAlive+' > '+last+' && '+posAlive+' >= '+playhead);utag.DB('DSH - HB Alive: '+i+'" -> '+posAlive+'",playhead: '+playhead+' alive_to_send => '+utag.data.rti_play_storage[b.video_play_request_id].alive[i].alive_to_send);}
var rti_alive_to_send=utag.data.rti_play_storage[b.video_play_request_id].alive["30"].alive_to_send===true?true:false;var rti_alive_to_send_pos=rti_alive_to_send?utag.data.rti_play_storage[b.video_play_request_id].alive["30"].alive_last_time:0;var rti_alive_to_send_live=type=="live"&&utag.data.rti_play_storage[b.video_play_request_id].alive["60"].alive_to_send===true?true:false;var rti_alive_to_send_live_pos=rti_alive_to_send_live?utag.data.rti_play_storage[b.video_play_request_id].alive["60"].alive_last_time:0;if((rti_alive_to_send||rti_alive_to_send_live)&&playhead>0){if(rti_alive_to_send_live==true&&(u.data.video_duration_in_s>0?rti_alive_to_send_live_pos<=u.data.video_duration_in_s:true)&&!u.data.is_complete&&!u.data.is_pause){wt_sendinfo_media(u.data.rti_webtrekk_video_mc,"live-alive",rti_alive_to_send_live_pos,u.data.video_duration_in_s,u.data.rti_webtrekk_video_mg,u.data.video_bandwidth,u.data.video_volume,u.data.video_mute);utag.DB(logPrefix+' Invio: '+"live-alive"+' '+rti_alive_to_send_live_pos);}
if(rti_alive_to_send==true&&(u.data.video_duration_in_s>0?rti_alive_to_send_pos<=u.data.video_duration_in_s:true)&&!u.data.is_complete&&!u.data.is_pause){wt_sendinfo_media(u.data.rti_webtrekk_video_mc,"pos",rti_alive_to_send_pos,u.data.video_duration_in_s,u.data.rti_webtrekk_video_mg,u.data.video_bandwidth,u.data.video_volume,u.data.video_mute);utag.DB(logPrefix+' Invio: '+"pos"+' '+rti_alive_to_send_pos);}}
var next=nextHb(playhead,30);utag.DB(logPrefix+' Nuovo timer HB: '+next);window.rtiTealliumVideoTimer.startTimer(prIDHb,next,false,sendHb);}
if(b.video_event_type!='complete'&&u.data.is_complete)
return;if(b.video_event_type&&typeof(b.video_playhead)!=='undefined'){if(__dshGlobalMethods.isAdv(b)||b.video_event_type=="pause"||b.video_event_type=="eof"||b.video_event_type=="stop"||b.video_event_type=="bufferStart"||b.video_event_type=="seek"){utag.DB('pauseTimer - Ricevuto '+b.video_event_type+' playhead '+b.video_playhead);window.rtiTealliumVideoTimer.pauseTimer(prIDHb);}
else if(!__dshGlobalMethods.isAdv(b)&&(b.video_event_type=="playing"||(b.video_event_type=="bufferEnd"&&!u.data.is_pause&&b.video_playhead>0))){if(b.video_playhead!=Math.round(window.rtiTealliumVideoTimer.playhead(prIDHb)/1000)){utag.DB('setPlayhead - Ricevuto '+b.video_event_type+' playhead '+b.video_playhead+' playheadTimer '+Math.round(window.rtiTealliumVideoTimer.playhead(prIDHb)/1000));window.rtiTealliumVideoTimer.setPlayhead(prIDHb,b.video_playhead*1000);}
var hb=nextHb(b.video_playhead);utag.DB('startTimer - Ricevuto '+b.video_event_type+' Calcolo prossimo HB '+hb+' playhead '+b.video_playhead);window.rtiTealliumVideoTimer.startTimer(prIDHb,hb,false,sendHb);}
else if(__dshGlobalMethods.isAdv(b)){window.rtiTealliumVideoTimer.pauseTimer(prIDHb);}}
if(b.video_event_type==='ready'){var mg=u.data.rti_webtrekk_video_ck!==""?u.data.rti_webtrekk_video_mg+";"+u.data.rti_webtrekk_video_ck:u.data.rti_webtrekk_video_mg;wt_sendinfo_media(u.data.rti_webtrekk_video_mc,"init",0,u.data.video_duration_in_s,mg,u.data.video_bandwidth,u.data.video_volume,u.data.video_mute);utag.DB(logPrefix+' Invio: init');}
else if(b.video_event_type.indexOf('adImpression')>-1){var adImp={'adImpressionStart':'start','adImpressionEnd':'stop'}
var mg=u.data.rti_webtrekk_video_ck!==""?u.data.rti_webtrekk_video_mg+";"+u.data.rti_webtrekk_video_ck:u.data.rti_webtrekk_video_mg;var slotName=b.video_ad_slot_type+'-'+(b.video_ad_slot_type=="midroll"?u.data.rti_midroll_count:(parseInt(b.video_ad_current_instance_index,10)+1))+'-'+adImp[b.video_event_type];wt_sendinfo_media(u.data.rti_webtrekk_video_mc,slotName,b.video_playhead,u.data.video_duration_in_s,mg,u.data.video_bandwidth,u.data.video_volume,u.data.video_mute);utag.DB(logPrefix+' Invio: '+slotName);}
else if(b.video_event_type==='playing'){if(u.data.seek_keep_watching.to_send){wt_sendinfo_media(u.data.rti_webtrekk_video_mc,"seek",u.data.seek_keep_watching.playhead,u.data.video_duration_in_s,u.data.rti_webtrekk_video_mg,u.data.video_bandwidth,u.data.video_volume,u.data.video_mute);utag.DB(logPrefix+' Invio: seekToStartTime '+b.video_playhead);utag.data.rti_play_storage[b.video_play_request_id].seek_keep_watching.to_clean=true;}
var mg=u.data.rti_webtrekk_video_ck!==""?u.data.rti_webtrekk_video_mg+";"+u.data.rti_webtrekk_video_ck:u.data.rti_webtrekk_video_mg;wt_sendinfo_media(u.data.rti_webtrekk_video_mc,"play",b.video_playhead,u.data.video_duration_in_s,mg,u.data.video_bandwidth,u.data.video_volume,u.data.video_mute);utag.DB(logPrefix+' Invio: play '+b.video_playhead);}
else if(b.video_event_type==='seek'&&u.data.last_played_type!=""){wt_sendinfo_media(u.data.rti_webtrekk_video_mc,"seek",b.video_playhead,u.data.video_duration_in_s,u.data.rti_webtrekk_video_mg,u.data.video_bandwidth,u.data.video_volume,u.data.video_mute);utag.DB(logPrefix+' Invio: seek '+b.video_playhead);}
else if(b.video_event_type==='pause'){wt_sendinfo_media(u.data.rti_webtrekk_video_mc,"pause",b.video_playhead,u.data.video_duration_in_s,u.data.rti_webtrekk_video_mg,u.data.video_bandwidth,u.data.video_volume,u.data.video_mute);utag.DB(logPrefix+' Invio: pause');}
else if(b.video_event_type==='complete'){wt_sendinfo_media(u.data.rti_webtrekk_video_mc,"eof",b.video_playhead,u.data.video_duration_in_s,u.data.rti_webtrekk_video_mg,u.data.video_bandwidth,u.data.video_volume,u.data.video_mute);window.rtiTealliumVideoTimer.pauseTimer(prIDHb);utag.DB(logPrefix+' Invio: eof');}
else if(b.video_event_type==='stop'){wt_sendinfo_media(u.data.rti_webtrekk_video_mc,"stop",b.video_playhead,u.data.video_duration_in_s,u.data.rti_webtrekk_video_mg,u.data.video_bandwidth,u.data.video_volume,u.data.video_mute);window.rtiTealliumVideoTimer.pauseTimer(prIDHb);utag.DB(logPrefix+' Invio: stop '+b.video_playhead);}
}};utag.o[loader].loader.LOAD(id);})("112","mediaset.med.ott.app.mediaset.it");}catch(error){utag.DB(error);}
